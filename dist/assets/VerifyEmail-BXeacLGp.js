import{u as E,a as y,r as b,b as S,j as e}from"./index-PRkFljG9.js";import{c as v,a as k,u as w,b as N,o as R,A as V,I as $,B as j}from"./formik.esm-BZ_oW9MO.js";import{S as L,o as T}from"./index-BAv8U_zI.js";const A=()=>{const a=E(),{id:o}=y(),c={code:""},l=v().shape({code:k().required("Verification code is required").matches(/^\d{4}$/,"Verification code must be exactly 4 digits")}),d=w({initialValues:c,validationSchema:l,onSubmit:async s=>{console.log("values",s);const g={email:o,token:s.code},{success:C}=await N.verifyEmail(g);C&&a(b.auth.onboarding)}}),u=()=>{a(b.auth.signup)},n=15*60,[t,i]=S.useState(n),[m,r]=S.useState(!1);S.useEffect(()=>{if(t>0){const s=setTimeout(()=>i(g=>g-1),1e3);return()=>clearTimeout(s)}else r(!0)},[t]);const f=()=>{i(n),r(!1)},h=Math.floor(t/60),p=t%60,x=`${h}m:${p.toString().padStart(2,"0")}s`;return{formik:d,id:o,changeEmailHandler:u,canResend:m,restartCountdown:f,timeLeft:x,secondsLeft:t}},H=()=>{const{formik:a,id:o,changeEmailHandler:c,canResend:l,restartCountdown:d,timeLeft:u,secondsLeft:n}=A(),{values:t,touched:i,handleBlur:m,errors:r,handleChange:f,handleSubmit:h,isSubmitting:p,isValid:x,dirty:s}=a;return e.jsxs("div",{className:"w-full flex flex-col items-center",children:[e.jsx(L,{steps:T,currentStep:1}),e.jsxs("div",{className:R,children:[e.jsx(V,{title:"Check your email",subTitle:`We sent a code to ${o}.`,action:{title:"Change email",onClick:c}}),e.jsxs("form",{onSubmit:h,className:"w-full flex flex-col gap-4",children:[e.jsx($,{label:"Verification code",name:"code",value:t.code,onChange:f,onBlur:m,errorMessage:r.code,touched:i.code,required:!0}),e.jsx(j,{title:"Continue",fullWidth:!0,type:"submit",loading:p,showArrow:!0,disabled:!(x&&s)}),e.jsx(j,{title:"Resend code",fullWidth:!0,disabled:!l,onClick:d}),n!==0&&e.jsxs("p",{className:"text-center",children:["Resend code in ",u]})]})]})]})};export{H as default};
